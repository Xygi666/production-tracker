<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#2c3e50">
  <title>–£—á—ë—Ç –ø—Ä–æ–¥—É–∫—Ü–∏–∏</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icon-192.png" sizes="192x192">
  <link rel="icon" href="icon-512.png" sizes="512x512">
  <link rel="stylesheet" href="styles.css">
</head>
<body data-theme="classic">
  <div class="app">
    <header class="header">
      <div class="header__container">
        <div class="header__brand">
          <h1 class="header__title">üìä –£—á—ë—Ç –ø—Ä–æ–¥—É–∫—Ü–∏–∏</h1>
          <div class="header__subtitle">–î–æ—Ö–æ–¥ –∑–∞ –º–µ—Å—è—Ü: <span id="monthSumHeader">0 ‚ÇΩ</span></div>
          <div class="header__subtitle">–ù–∞ —Ä—É–∫–∏ (–∏—Ç–æ–≥): <span id="finalAmountHeader">0 ‚ÇΩ</span></div>
        </div>
        <div class="header__actions">
          <button id="settingsBtn" class="btn btn--sm btn--outline">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
          <button id="exportJsonBtn" class="btn btn--sm btn--outline">üíæ –≠–∫—Å–ø–æ—Ä—Ç JSON</button>
          <button id="reloadBtn" class="btn btn--sm btn--outline">üîÑ</button>
        </div>
      </div>
    </header>

    <nav class="nav">
      <div class="nav__container">
        <button class="nav__tab nav__tab--active" data-tab="records">üìù –£—á—ë—Ç</button>
        <button class="nav__tab" data-tab="statistics">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
        <button class="nav__tab" data-tab="history">üìã –ò—Å—Ç–æ—Ä–∏—è</button>
      </div>
    </nav>

    <main class="main">
      <div class="main__container">
        <section class="screen screen--active" data-screen="records">
          <div class="form-group">
            <label for="productSearch">–ü—Ä–æ–¥—É–∫—Ç</label>
            <div class="product-search">
              <input id="productSearch" class="form-control" type="text" placeholder="–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ">
              <button id="clearSearchBtn" class="search-clear-btn hidden">√ó</button>
              <div id="productSuggestions" class="suggestions hidden"></div>
            </div>
          </div>
          <div class="form-group">
            <label for="quantityInput">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (—à—Ç.)</label>
            <div class="quantity-control">
              <button id="decreaseBtn" class="btn btn--round">‚àí</button>
              <input id="quantityInput" class="form-control" type="number" step="1" inputmode="numeric" placeholder="–ú–æ–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è">
              <button id="increaseBtn" class="btn btn--round">+</button>
            </div>
          </div>
          <div id="presetsContainer" class="presets"></div>
          <div class="form-group">
            <div class="sum-display">
              <span>–°—É–º–º–∞: </span><span id="sumAmount" class="sum-amount">0 ‚ÇΩ</span>
            </div>
          </div>
          <button id="addRecordBtn" class="btn btn--primary btn--full">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å</button>
          <div class="records-list">
            <div class="list-header">
              <h3>–ó–∞–ø–∏—Å–∏ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞</h3>
              <button id="exportCsvBtn" class="btn btn--sm btn--outline">üìä –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
            </div>
            <div id="recordsList" class="records-items"></div>
          </div>
        </section>

        <section class="screen" data-screen="statistics">
          <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü</h2>
          <div id="statsGrid" class="stats-grid"></div>
        </section>

        <section class="screen" data-screen="history">
          <div class="history-header">
            <h2>–ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π</h2>
            <div class="history-filters">
              <input id="filterDate" class="form-control" type="date">
              <select id="filterAction" class="form-control">
                <option value="">–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è</option>
                <option value="add_record">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏</option>
                <option value="delete_record">–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏</option>
                <option value="add_product">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞</option>
                <option value="edit_product">–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞</option>
                <option value="delete_product">–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞</option>
                <option value="settings">–ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫</option>
              </select>
              <button id="exportHistoryBtn" class="btn btn--sm btn--outline">üìÑ –≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏</button>
            </div>
          </div>
          <div id="historyList" class="history-list"></div>
        </section>
      </div>
    </main>
  </div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–∞ -->
  <div id="productModal" class="modal">
    <div class="modal__backdrop"></div>
    <div class="modal__content modal__content--sm">
      <div class="modal__header">
        <h3 id="productModalTitle">–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç</h3>
        <button id="closeProductBtn" class="modal__close">√ó</button>
      </div>
      <div class="modal__body">
        <div class="form-group">
          <label for="productNameInput">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞</label>
          <input id="productNameInput" class="form-control" type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
        </div>
        <div class="form-group">
          <label for="productPriceInput">–¶–µ–Ω–∞</label>
          <input id="productPriceInput" class="form-control" type="number" step="0.01" min="0.01" inputmode="decimal" placeholder="0.00">
        </div>
        <div class="form-group">
          <label for="productDefectPriceInput">–¶–µ–Ω–∞ –±—Ä–∞–∫–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π)</label>
          <input id="productDefectPriceInput" class="form-control" type="number" step="0.01" inputmode="decimal" placeholder="-200">
        </div>
      </div>
      <div class="modal__footer">
        <button id="saveProductBtn" class="btn btn--primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button id="cancelProductBtn" class="btn btn--outline">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js').catch(()=>{});
      });
    }
  </script>
</body>
</html>
